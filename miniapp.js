"use strict";const movements=[{group:"Squat",movements:[{mid:0,label:"Squats"},{mid:1,label:"Highbar squats"},{mid:2,label:"Paused squats"},{mid:3,label:"Front squats"},{mid:4,label:"SSB squats"},{mid:21,label:"Highbar paused squats"}]},{group:"Bench",movements:[{mid:5,label:"Bench press"},{mid:6,label:"Medium grip bench press"},{mid:7,label:"Close grip bench press"},{mid:8,label:"Larsen press"},{mid:9,label:"Close grip Larsen press"},{mid:10,label:"Medium grip Larsen pin press"},{mid:20,label:"Incline press"},{mid:22,label:"Log press"},{mid:23,label:"Floor press"}]},{group:"Deadlift",movements:[{mid:11,label:"Deadlifts"},{mid:12,label:"Deficit deadlifts"},{mid:13,label:"Snatch grip deadlifts"},{mid:14,label:"Block pulls"},{mid:25,label:"Sumo deadlifts"}]},{group:"Other",movements:[{mid:15,label:"Sealrow"},{mid:16,label:"Standing row"},{mid:17,label:"Pullups"},{mid:18,label:"Weighted pullups"},{mid:19,label:"Weighted dips"},{mid:24,label:"Bulgarian split squats"}]}],standardPrograms=[{title:"Basic training program",shareString:"ko0408084448k-2+48484A0c4448s-2+4c448-23Wkk484g04w8084448k-2+48484A0c4448s-2+4c448-23Wkk484g0488084448k-2+48484A0c4448s-2+4c448-23Wkk484g04A8084448k-2+48484A0c4448s-2+4c448-23Wkk484g04I8084448k-2+48484A0c4448s-2+4c448-23Wkk484g04E8084448k-2+48484A0c4448s-2+4c448-23Wkk484g"},{title:"Swiss program",shareString:"kk0808084448k-2+48484A0c4448s-2+4c448-23Wkk484g-21i8084448w-2+48484w0c4448E-2+4c448-23Wkk484g08k8084448k-2+48484A0c4448s-2+4c448-23Wkk484g-21m8084448k-2+48484A0c4448s-2+4c448-23Wkk484g08I8084448k-2+48484A0c4448s-2+4c448-23Wkk484gs8084448w-2+48484w0c4448E-2+4c448-23Wkk484g08-21u8084448k-2+48484A0c4448s-2+4c448-23Wkk484g-21q8084448k-2+48484w0c4448s-2+4c448-23Wkk484g08-21C8084448w-2+48484w0c4448E-2+4c448-23Wkk484g-21u8084448w-2+48484w0c4448E-2+4c448-23Wkk484g"},{title:"Oldschool linear",shareString:"oo04040c4448E-2+4c448-23Kgk448E-2+404w40c4448E-2+4c448-23Kgk448E-2+404840c4448E-2+4c448-23Kgk448E-2+404A40c4448E-2+4c448-23Kgk448E-2+404I40c4448E-2+4c448-23Kgk448E-2+404E40c4448E-2+4c448-23Kgk448E-2+4"},{title:"Advanzed program",shareString:"ko0408084448k-2+48484A0c4448s-2+4c448-23Wkk484g04wk088484Ac484-25a088484Ac484-25u088484Ac484-25O088484Ac484-268088484Ac484-23S0488084448k-2+48484A0c4448s-2+4c448-23Wkk484g04Ak088484Ac484-25a088484Ac484-25u088484Ac484-25O088484Ac484-268088484Ac484-23S04I8084448k-2+48484A0c4448s-2+4c448-23Wkk484g04Ek088484Ac484-25a088484Ac484-25u088484Ac484-25O088484Ac484-268088484Ac484-23S"}],maxFormula=(e,t)=>e*(36/(37-t)),rpeBasedMax=a=>r=>t=>e=>maxFormula(r,t+(11-e-a)),oneRepMax=rpeBasedMax(1),presentableWeightValue=e=>{e=2.5*Math.round(e/2.5);return 0<e?e:""},b62Chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),decToB62=e=>{if(0==e)return 0;let t="";var r=e<0?"+":"";let a=(4*Math.abs(e)).toFixed();for(;0<a;)t=b62Chars[a%62]+t,a=(a-a%62)/62;return r+t},b62ToDec=e=>{var t="+"===e[0];const r="+"===e[0]?e.slice(1):e;e=r.split("").map(t=>b62Chars.findIndex(e=>e==t)).reverse().map((e,t)=>e*62**t).reduce((e,t)=>e+t)/4;return t?-1*e:e};class IdCreator{static latestId=1e3;static resetId(){this.latestId=1e3}static getUniqueId(){return this.latestId++}}const getStoredKeys=()=>[...Array(localStorage.length).keys()].map(e=>localStorage.key(e)),getB62FromKeyVal=(e,t)=>decToB62([e,t].join("")),removeStoredInputKeys=()=>getStoredKeys().filter(e=>e.match(/^\d{4}$/g)).map(e=>{localStorage.removeItem(e)}),getShareString=()=>getStoredKeys().filter(e=>e.match(/^\d{4}$/g)).map(e=>getB62FromKeyVal(e,localStorage.getItem(e))).join("-"),getKeyValFromB62=e=>{const t=b62ToDec(e).toString(10);return[t.slice(0,4),t.slice(4)]},parseShareString=e=>e.split("-").map(e=>getKeyValFromB62(e)),autosaveProgress=()=>{var e=(new Date).toISOString().slice(0,10),t=getSetting("9999")(0);const r=getShareString();1<r.split("-").length&&localStorage.setItem(`progress-${t}-`+e,getShareString())},importFromShareString=e=>{autosaveProgress(),removeStoredInputKeys(),parseShareString(e).map(e=>saveSetting(e[0])(e[1]))},saveSetting=t=>e=>localStorage.setItem(t,e),getSetting=t=>e=>localStorage.getItem(t)?localStorage.getItem(t):e,saveProgram=(e,t)=>{localStorage.setItem("program-"+e,t)},getSavedPrograms=()=>{return getStoredKeys().filter(e=>e.match(/^program-/g)).map(e=>({title:e.substring("program-".length),shareString:localStorage.getItem(e)}))},getAllAvaliablePrograms=()=>[...standardPrograms,...getSavedPrograms()],getBrilliantElement=(e,t,r)=>{const a=document.createElement(e);return a.classList.add(...t),"string"==typeof r?a.textContent=r:Array.isArray(r)?a.append(...r):"object"==typeof r&&a.appendChild(r),a},getBrilliantRow=e=>getBrilliantElement("tr",[],e.map(e=>getBrilliantElement("td",[],e))),getBrilliantHeaderRow=e=>getBrilliantElement("tr",[],e.map(e=>getBrilliantElement("th",[],e))),getBrilliantCheckBox=()=>{const e=document.createElement("input");return e.id=IdCreator.getUniqueId(),e.onchange=()=>saveSetting(e.id)(e.checked?1:0),e.setAttribute("type","checkBox"),e.checked="1"===getSetting(e.id)(0),e},getBrilliantNumberInput=(e,t,r,a)=>{const n=document.createElement("input");return t<100&&1==r&&n.classList.add("smallInput"),n.id=IdCreator.getUniqueId(),n.onchange=()=>saveSetting(n.id)(n.value),n.setAttribute("type","number"),n.value=getSetting(n.id)(a),n.min=e,n.max=t,n.step=r,n},getBrilliantDisabledInput=e=>{const t=document.createElement("input");return t.setAttribute("type","text"),t.value=e,t.disabled=!0,t},getShareContainer=()=>{const l=getBrilliantElement("div",["shareLinkContainer"]);return l.hidden=!0,l.addEventListener("toggleVisibility",()=>{for(;l.firstChild;)l.removeChild(l.firstChild);l.append(...getStoredKeys().filter(e=>e.match(/\d{4}-\d{2}-\d{2}$/g)).sort().map(e=>{const t=getBrilliantElement("div",["shareStringContainer"],getBrilliantElement("label",["shareStringLabel"],e)),r=getBrilliantElement("button",["clearButton"],"ðŸ—‘"),a=(r.onclick=()=>{localStorage.removeItem(e),l.dispatchEvent(new Event("toggleVisibility"))},getBrilliantElement("input",["presentedlink"],"")),n=(a.type="text",a.value=localStorage.getItem(e),getBrilliantElement("button",[],"Copy")),i=(n.onclick=()=>{a.select(),document.execCommand("copy")},getBrilliantElement("button",[],"Restore"));return i.onclick=()=>{importFromShareString(a.value),ProgramContainer.renderProgram()},t.append(r,a,n,i),t}));const e=getBrilliantElement("div",["shareStringContainer"]),t=getBrilliantElement("button",[],"Save current"),r=(t.onclick=()=>{autosaveProgress(),l.dispatchEvent(new Event("toggleVisibility"))},getBrilliantElement("button",["closebutton"],"â–² â–² â–²"));r.onclick=()=>{l.hidden=!l.hidden},e.append(t),l.append(e,r)}),l},getBrilliantAnchorLinkList=e=>{const t=[...Array(e.numberOfIterations).keys()],r=getBrilliantElement("div",["linkList"]),a=getBrilliantElement("button",[],"ðŸ› ");a.onclick=()=>{ProgramSettingsContainer.toggleVisibility()};e=t.map(e=>{const t=getBrilliantElement("a",["cyclelink","weekelement"],"Week"+(e+1));return t.href="#cycle"+e,t});const n=getBrilliantElement("button",[],"ðŸ’¾"),i=getShareContainer();return n.onclick=()=>{i.dispatchEvent(new Event("toggleVisibility")),i.hidden=!i.hidden},r.append(...e,a,n,ProgramSettingsContainer.programSettingsContainer,i),r},getMovementSelect=(e,t)=>{const r=getBrilliantElement("select",["movementselect"]),a=(r.setAttribute("cascade",t),r.id=IdCreator.getUniqueId(),getSetting(r.id)(e));r.onchange=()=>{saveSetting(r.id)(r.value),[...document.querySelectorAll(`select[cascade$=${CSS.escape(t.slice(1))}]`)].filter(e=>e.getAttribute("cascade")[0]>t[0]).map(e=>{e.value=r.value,saveSetting(e.id)(r.value)})};e=movements.map(e=>{const t=getBrilliantElement("optgroup",[],e.movements.map(e=>{const t=getBrilliantElement("option",[],e.label);return t.value=e.mid,e.mid==a&&(t.selected=!0),t}));return t.label=e.group,t});return r.append(...e),r},getDumbMovementSelect=r=>{const e=getBrilliantElement("select",["dumbmovementselect"]);var t=movements.map(e=>{const t=getBrilliantElement("optgroup",[],e.movements.map(e=>{const t=getBrilliantElement("option",[],e.label);return t.value=e.mid,e.mid==r&&(t.selected=!0),t}));return t.label=e.group,t});return e.append(...t),e},getSessionMovementTable=(c,r,e)=>{const t=getBrilliantElement("fieldset",["dayContainer"],getBrilliantElement("legend",[],"Day "+(r+1)));return t.id=c+"-"+r,t.append(...e.map((p,e)=>{const g=[],t=p.sets.map(e=>Array(e.repeat(c)).fill(e)).flat();return getBrilliantElement("table",["movementContainer"],[getBrilliantElement("caption",[],getMovementSelect(p.movementId,c+"-"+r+e)),getBrilliantHeaderRow(["","Reps","Goal RPE","% of e1RM","Weight","Actual RPE","e1RM"]),...t.map((r,e)=>{const t=getBrilliantNumberInput(0,10,1,r.reps(c));var a=getBrilliantDisabledInput(null!==r.perc(c)?r.perc(c)+"%":null);const n=null!==r.perc(c)?getBrilliantDisabledInput(r.weight(c)):getBrilliantNumberInput(75,1e3,2.5,r.weight(c)),i=getBrilliantNumberInput(1,11,.25,r.rpe(c));var l=getBrilliantDisabledInput(r.rpe(c));const s=getBrilliantDisabledInput("...");if(null!==r.perc(c)){const m=()=>{var e=ProgramSettingsContainer.movementsMaxMap.get(p.movementId)??0,e=g.reduce((e,t)=>Math.max(Number(e),Number(t.value)),e),t="function"==typeof r.perc?r.perc(c):Number(r.perc);n.value=presentableWeightValue(t*e/100)};m(),g.map(e=>e.addEventListener("change",m)),ProgramSettingsContainer.movementsMaxInputMap.has(p.movementId)&&ProgramSettingsContainer.movementsMaxInputMap.get(p.movementId).addEventListener("change",m)}g.push(s);const o=()=>n.value&&t.value&&i.value?oneRepMax(Number(n.value))(Number(t.value))(Number(i.value)):null;return s.value=presentableWeightValue(o()),[t,n,i].map(e=>e.addEventListener("input",()=>{s.value=presentableWeightValue(o()),s.dispatchEvent(new Event("change"))})),getBrilliantRow([getBrilliantCheckBox(),t,l,a,n,i,s])}).flat()])})),t},getBrilliantDateInput=e=>{const t=document.createElement("input");t.id=IdCreator.getUniqueId(),t.onchange=()=>saveSetting(t.id)(t.valueAsNumber/1e5),t.setAttribute("type","date");e=1e5*getSetting(t.id)(e);return e&&(t.valueAsNumber=e),t};class ProgramSettingsContainer{static programSettingsContainer=getBrilliantElement("div",["programSettingsContainer"]);static toggleVisibility=()=>{this.programSettingsContainer.hidden=!this.programSettingsContainer.hidden};static movementsMaxMap=new Map;static movementsTitleMap=new Map(movements.map(e=>e.movements.map(e=>[e.mid,e.label])).flat());static movementsMaxInputMap=new Map;static initProgramSettingsContainer=e=>{this.movementsMaxInputMap=new Map,this.movementsMaxMap=new Map;var t=getBrilliantElement("h2",[],"Program settings");const r=getBrilliantElement("div",["programSettingsContainer"]),a=(r.id="programSettings",r.append(t),getBrilliantElement("button",["clearButton"],"ðŸ—‘")),n=(a.onclick=()=>{removeStoredInputKeys(),ProgramContainer.renderProgram()},r.append(getBrilliantElement("div",["cleanSlateContainer"],["Reset program:",a])),e.days.map(e=>e.filter(e=>e.sets.some(e=>null!==e.rpe(1)&&null!==e.reps(1))).map(e=>e.movementId)).flat()),i=e.days.map(e=>e.filter(e=>e.sets.every(e=>null===e.rpe(1)||null===e.reps(1))).map(e=>e.movementId)).flat(),l=(r.append(...[{title:"Required e1RMs",movs:i},{title:"Optional e1RMs",movs:n}].map(e=>0<e.movs.length?getBrilliantElement("table",["settingsTable"],[getBrilliantElement("caption",[],e.title+":"),getBrilliantHeaderRow(["Movment","e1RM"]),...e.movs.map(e=>{const t=getBrilliantNumberInput(75,1e3,2.5);return t.addEventListener("change",()=>{this.movementsMaxMap.set(e,t.value)}),this.movementsMaxInputMap.set(e,t),this.movementsMaxMap.set(e,t.value),getBrilliantRow([this.movementsTitleMap.get(e),t])})]):null).filter(e=>null!==e)),0!=i.length&&![...this.movementsMaxInputMap.keys()].filter(e=>i.includes(e)).every(e=>0<this.movementsMaxInputMap.get(e).value)||(r.hidden=!0),getBrilliantElement("button",["closebutton"],"â–² â–² â–²"));l.onclick=this.toggleVisibility,r.append(ProgramEditor.getProgramEditorButton(),ProgramEditor.getNewProgramButton(),l),this.programSettingsContainer=r}}class ProgramEditor{static programEditorContainer=null;static toggleVisibility=()=>{this.programEditorContainer.hidden=!this.programEditorContainer.hidden,window.scrollTo({top:0,behavior:"smooth"})};static getNewProgramButton=()=>{const e=getBrilliantElement("button",[],"Create new program");return e.onclick=()=>{autosaveProgress(),removeStoredInputKeys(),ProgramContainer.renderProgram({title:"New program",shareString:"k0"})},e};static getProgramEditorButton=()=>{const e=getBrilliantElement("button",[],"Edit Program");return e.onclick=this.toggleVisibility,e};static initProgramEditorContainer=(e,t)=>{const r=fillSetParams(parseSharableProgram(e,t)),a=getBrilliantElement("div",["programEditorContainer"]),l=(e,t,r)=>{r.value="text"===r.type?e[t]:Number(e[t]),r.addEventListener("change",()=>{e[t]=r.value})},n=getBrilliantElement("button",[],"Close program editor"),i=(n.onclick=this.toggleVisibility,getBrilliantElement("input",[])),s=(i.setAttribute("type","text"),l(r,"title",i),i.value=r.title,getBrilliantElement("input",[])),o=(s.setAttribute("type","number"),s.addEventListener("change",()=>m.dispatchEvent(new Event("render"))),l(r,"numberOfIterations",s),a.append(n,getBrilliantElement("div",["editorFieldBox"],[getBrilliantElement("label",[],"Title"),i]),getBrilliantElement("div",["editorFieldBox"],[getBrilliantElement("label",[],"Number of iterations/weeks"),s])),new Map([[PROGRESSION_NONE,{optionLabel:"None",nrOfParams:0}],[PROGRESSION_LINEAR,{optionLabel:"Linear",nrOfParams:2}],[PROGRESSION_CONSTANT,{optionLabel:"Constant",nrOfParams:1}],[PROGRESSION_STEPS,{optionLabel:"Steps",nrOfParams:r.numberOfIterations}]])),m=getBrilliantElement("div",["allDaysContainer"]),p=(m.addEventListener("render",e=>{for(;m.firstChild;)m.removeChild(m.firstChild);m.append(...r.days.map((i,e)=>{const t=getBrilliantElement("fieldset",["dayEditContainer"]);return t.append(getBrilliantElement("legend",[],["Day "+(e+1),((e,t,r)=>{const a=getBrilliantElement("button",["clearButton"],"ðŸ—‘");return a.onclick=()=>{e.remove(),t.days.splice(r,1),m.dispatchEvent(new Event("render"))},a})(t,r,e)]),...i.map((a,e)=>{const t=getBrilliantElement("div",["movementEditContainer"]);var r=a.sets.map((e,t)=>{const r=getBrilliantElement("div",["setContainer"]);return r.append(getBrilliantElement("h3",[],"Set "+(t+1)),((e,t,r)=>{const a=getBrilliantElement("button",["clearButton"],"ðŸ—‘");return a.onclick=()=>{e.remove(),t.sets.splice(r,1),m.dispatchEvent(new Event("render"))},a})(r,a,t),...Object.entries(e).map(([e,a])=>{const t=getBrilliantElement("div",["progressionContainer"]),n=getBrilliantElement("select",["progressionSelect"]),r=getBrilliantElement("div",["progressionEditor"]);return o.forEach((e,t)=>{const r=getBrilliantElement("option",[],e.optionLabel);(r.value=t)===a.type&&(r.selected=!0),n.append(r)}),l(a,"type",n),n.addEventListener("change",()=>{for(;r.firstChild;)r.removeChild(r.firstChild);const e=new Map([[PROGRESSION_NONE,0],[PROGRESSION_LINEAR,2],[PROGRESSION_CONSTANT,1],[PROGRESSION_STEPS,10]]);r.append(((a,e)=>{const t=getBrilliantElement("div",["paramsContainer"]),r=Array(e).fill();e=r.map((e,t)=>{const r=getBrilliantElement("input",["paramInput"]);return r.setAttribute("type","number"),r.min=-1e3,r.max=1e3,r.step=.25,l(a,t,r),getBrilliantElement("div",["paramBox"],[getBrilliantElement("label",[],"Param "+(t+1)),r])});return t.append(...e),t})(a.params,e.get(Number(n.value))))}),n.dispatchEvent(new Event("change")),t.append(getBrilliantElement("label",["progressionLabel"],e),n,r),t})),r}),n=getDumbMovementSelect(a.movementId);return l(a,"movementId",n),t.append(getBrilliantElement("h3",[],"Movement "+(e+1)),((e,t,r)=>{const a=getBrilliantElement("button",["clearButton"],"ðŸ—‘");return a.onclick=()=>{e.remove(),t.splice(r,1),m.dispatchEvent(new Event("render"))},a})(t,i,e),n,...r,(e=>{const t=getBrilliantElement("button",[],"Add set");return t.onclick=()=>{e.sets.push({reps:{type:PROGRESSION_NONE,params:[]},rpe:{type:PROGRESSION_NONE,params:[]},perc:{type:PROGRESSION_NONE,params:[]},weight:{type:PROGRESSION_NONE,params:[]},repeat:{type:PROGRESSION_NONE,params:[]}}),m.dispatchEvent(new Event("render"))},t})(a)),t}),(e=>{const t=getBrilliantElement("button",[],"Add movement");return t.onclick=()=>{e.push({movementId:0,sets:[{reps:{type:PROGRESSION_NONE,params:[]},rpe:{type:PROGRESSION_NONE,params:[]},perc:{type:PROGRESSION_NONE,params:[]},weight:{type:PROGRESSION_NONE,params:[]},repeat:{type:PROGRESSION_NONE,params:[]}}]}),m.dispatchEvent(new Event("render"))},t})(i)),t}),(e=>{const t=getBrilliantElement("button",[],"Add day");return t.onclick=()=>{e.days.push([{movementId:0,sets:[{reps:{type:PROGRESSION_NONE,params:[]},rpe:{type:PROGRESSION_NONE,params:[]},perc:{type:PROGRESSION_NONE,params:[]},weight:{type:PROGRESSION_NONE,params:[]},repeat:{type:PROGRESSION_NONE,params:[]}}]}]),m.dispatchEvent(new Event("render"))},t})(r))}),m.dispatchEvent(new Event("render")),a.append(m),getBrilliantElement("button",[],"Save and render program"));p.onclick=()=>{var e=getSharableProgram(r);saveProgram(r.title,e),ProgramContainer.renderProgram({title:r.title,shareString:e})},a.append(p),a.hidden=!(t.length<3),this.programEditorContainer=a}}const getProgramSelect=e=>{const t=getBrilliantElement("select",["programselect"]),r=(t.id=9999,t.value=0,t.onchange=()=>{autosaveProgress(),removeStoredInputKeys(),saveSetting(t.id)(t.value),ProgramContainer.renderProgram(e[t.value])},getBrilliantElement("option",[],"â‰¡"));return r.disabled=!0,r.selected=!0,t.append(r),t.append(...e.map((e,t)=>{const r=getBrilliantElement("option",[],e.title);return r.value=t,r})),t},PROGRESSION_LINEAR=1,PROGRESSION_CONSTANT=2,PROGRESSION_NONE=3,PROGRESSION_STEPS=4,progressions={linear:(...t)=>e=>t[0]+t[1]*e,constant:(...t)=>e=>t[0],none:()=>e=>null,steps:(...t)=>e=>t[e%t.length]},getProgressionFormula=e=>{if("function"==typeof e)return e;if(void 0===e)return progressions.none();if(null==e)return progressions.none();if("number"==typeof e)return progressions.constant(e);if("object"==typeof e){if(e.type===PROGRESSION_LINEAR)return progressions.linear(...e.params);if(e.type===PROGRESSION_CONSTANT)return progressions.constant(...e.params);if(e.type===PROGRESSION_NONE)return progressions.none();if(e.type===PROGRESSION_STEPS)return progressions.steps(...e.params)}return progressions.none()},fillSetParams=e=>({numberOfIterations:e.numberOfIterations,title:e.title,days:e.days.map(e=>e.map(e=>({movementId:e.movementId,sets:e.sets.map(e=>({reps:e.hasOwnProperty("reps")?e.reps:{type:PROGRESSION_NONE,params:[]},rpe:e.hasOwnProperty("rpe")?e.rpe:{type:PROGRESSION_NONE,params:[]},perc:e.hasOwnProperty("perc")?e.perc:{type:PROGRESSION_NONE,params:[]},weight:e.hasOwnProperty("weight")?e.weight:{type:PROGRESSION_NONE,params:[]},repeat:e.hasOwnProperty("repeat")?e.repeat:{type:PROGRESSION_NONE,params:[]}}))})))}),readyProgram=e=>({numberOfIterations:e.numberOfIterations,title:e.title,days:e.days.map(e=>e.map(e=>({movementId:e.movementId,sets:e.sets.map(e=>({reps:getProgressionFormula(e.reps),rpe:getProgressionFormula(e.rpe),perc:getProgressionFormula(e.perc),weight:getProgressionFormula(e.weight),repeat:null==e.repeat||void 0===e.repeat?progressions.constant(1):getProgressionFormula(e.repeat)}))})))}),setParams={reps:1,rpe:2,perc:3,weight:4,repeat:5},convertRawProgressionToArray=(e,t)=>"object"==typeof t&&t.type!=PROGRESSION_NONE?[e,1,t.type,t.params.length,t.params]:[],getSharableProgram=e=>[e.numberOfIterations,e.days.length,e.days.map(e=>[0,e.length,e.map(e=>[e.movementId,e.sets.length,e.sets.map(e=>[0,Object.values(e).filter(e=>e.type!=PROGRESSION_NONE).length,...convertRawProgressionToArray(setParams.reps,e.reps),...convertRawProgressionToArray(setParams.rpe,e.rpe),...convertRawProgressionToArray(setParams.perc,e.perc),...convertRawProgressionToArray(setParams.weight,e.weight),...convertRawProgressionToArray(setParams.repeat,e.repeat)])])])].flat(8).map(e=>decToB62(e)).map(e=>1<e.length?"-"+e.length+e:e).join(""),parseShortened=e=>e.split(/(?=-)/g).map(e=>"-"===e[0]?[e.slice(2,2+Number(e[1])),...e.slice(2+Number(e[1])).split("")]:e.split("")).flat(),parseSharableProgram=(e,t)=>{const r=parseShortened(t).map(e=>b62ToDec(e));const a=e=>({type:e[0][0],params:e[0].slice(1).flat()});return{numberOfIterations:r[0],title:e,days:((e,t)=>{const r=[0,0,0,0,0,0,e],a=[];let n=!1,i=!0;return t.forEach(e=>{var t=r.findIndex(e=>0<e);i?(6==t?a.push([e]):5==t?a.at(-1).push([e]):4==t?a.at(-1).at(-1).push([e]):3==t?a.at(-1).at(-1).at(-1).push([e]):2==t?a.at(-1).at(-1).at(-1).at(-1).push([e,[]]):1==t?a.at(-1).at(-1).at(-1).at(-1).at(-1).push([e,[]]):0==t&&a.at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).push([e,[]]),i=!1,n=!0):-1<t&&(n?(r[t-1]=e,n=!1,i=2<t):6==t?a.at(-1).push([e]):5==t?a.at(-1).at(-1).push(e):4==t?a.at(-1).at(-1).at(-1).push(e):3==t?a.at(-1).at(-1).at(-1).at(-1).push(e):2==t?a.at(-1).at(-1).at(-1).at(-1).at(-1).push(e):1==t?a.at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).push(e):0==t&&a.at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).push(e),--r[t],r.slice(0,t+1).every(e=>0==e)&&(n=!0,i=!0))}),a})(r[1],r.slice(2)).filter(e=>"object"==typeof e&&0<e.length).map(e=>e.filter(e=>"object"==typeof e&&0<e.length).map(e=>({movementId:e[0],sets:e.slice(1).filter(e=>"object"==typeof e&&0<e.length).map(e=>{const t={};return e.slice(1).map(e=>{e[0]==setParams.reps?t.reps=a(e.slice(1)):e[0]==setParams.rpe?t.rpe=a(e.slice(1)):e[0]==setParams.perc?t.perc=a(e.slice(1)):e[0]==setParams.weight?t.weight=a(e.slice(1)):e[0]==setParams.repeat&&(t.repeat=a(e.slice(1)))}),t})})))}};class ProgramContainer{static appContainer=getBrilliantElement("div",["appContainer"]);static first=!0;static renderProgram(e){for(IdCreator.resetId();this.appContainer.firstChild;)this.appContainer.removeChild(this.appContainer.firstChild);var t=getAllAvaliablePrograms();let r=t[getSetting("9999")(0)];"object"==typeof e&&(r=e);e=parseSharableProgram(r.title,r.shareString);ProgramEditor.initProgramEditorContainer(r.title,r.shareString);const a=readyProgram(e),n=(ProgramSettingsContainer.initProgramSettingsContainer(a),getBrilliantElement("div",["programContainer"])),i=[...Array(a.numberOfIterations).keys()],l=(n.append(...i.map(r=>{var e=getBrilliantElement("h2",[],"Week "+(r+1));const t=getBrilliantElement("div",["blockContainer","weekelement"],e);return t.id="cycle"+r,t.append(...a.days.map((e,t)=>getSessionMovementTable(r,t,e))),t})),getBrilliantElement("div",["headerContainer"]));l.append(getBrilliantElement("h1",["programHeader"],r.title),getProgramSelect(t),getBrilliantAnchorLinkList(a)),this.appContainer.append(l,ProgramEditor.programEditorContainer,n),this.first&&(document.body.append(this.appContainer),this.first=!1)}}void 0===getSetting("9999")()&&saveSetting("9999")(0),ProgramContainer.renderProgram();